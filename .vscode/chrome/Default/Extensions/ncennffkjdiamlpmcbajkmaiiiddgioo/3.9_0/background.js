function RequestItem(){this.headers={};this.headers["user-agent"]="";this.headers["referer"]="";this.headers["cookie"]="";this.headers["content-type"]="";this.headers["content-disposition"]="";this.headers["host"]="";this.headers["content-length"]=0;this.headers["access-control-allow-origin"]="";this.url="";this.fileName="";this.ext="";this.postData="";this.tabId=undefined}Backgroud.prototype={MIME_TYPE_ARRAY:["video/x-flv","video/flv","video/mp4","video/x-mp4","video/mpeg","video/f4v","application/octet-stream","video/x-matroska","video/x-webm","audio/x-webm","audio/mp4","video/quicktime","video/x-ms-wmv","audio/webm","video/webm","video/f4f","audio/mpeg","application/vnd.apple.mpegurl","application/x-mpegURL","vnd.apple.mpegURL","application/xml"],SUPPORT_MEDIA_EXT_ARRAY:["swf","mp3","wma","wmv","mpg","wav","flv","f4v","3gp","mp4","rm","rmvb","mpeg","webm","hlv","mkv","ts"],SUPPORT_REQUEST_TYPE_ARRAY:["main_frame","sub_frame","object","xmlhttprequest","other","media"],requestItems:{},blockDownload:false,tabUrls:{},currentTabId:undefined,isSupportRequestType:function(e){e=e.toLowerCase();for(var t in this.SUPPORT_REQUEST_TYPE_ARRAY){if(e===this.SUPPORT_REQUEST_TYPE_ARRAY[t]){return true}}return false},isFrameRequestType:function(e){if(e==="main_frame"||e==="sub_frame"){return true}return false},isSupportContentType:function(e){e=e.toLowerCase();for(var t in this.MIME_TYPE_ARRAY){if(e.toLowerCase()===this.MIME_TYPE_ARRAY[t]){return true}}return false},isSupportMediaExt:function(e){e=e.toLowerCase();for(var t in this.SUPPORT_MEDIA_EXT_ARRAY){if(e.toLowerCase()===this.SUPPORT_MEDIA_EXT_ARRAY[t]){return true}}return false},getDispositionFileName:function(e){var t=new RegExp("filename[^;=\n]*=((['\"]).*?|[^;\n]*)").exec(e);if(null===t){return""}var i=t[1];return i=i.replace(/"([^"]*)"/g,"$1"),i=i.replace("UTF-8''",""),decodeURIComponent(i.replace(/\+/g,""))},getFileNameExt:function(e){var t="";if(e.length>0){var i=e.lastIndexOf(".");if(-1!==i){t=e.substr(i);t=t.toLowerCase()}}return t},getUrlFileName:function(e){var t=e.replace(/\?.*$/,"").replace(/.*\//,"");return decodeURIComponent(t)},isValidDownload:function(e){var t="";var i=e.headers["content-disposition"];if(i.length>0){t=this.getDispositionFileName(i)}if(0===t.length){t=this.getUrlFileName(e.url)}if(0===t.length){return false}e.fileName=t;var a=e.headers["content-type"];if(-1!==a.indexOf("text/")&&(-1===a.indexOf("text/multipart")||0===t.length)){return false}var s=this.getFileNameExt(t);e.ext=s;if(!this.canDownload(e)){return false}return this.isMonitorFileExt(s)},updateContextMenu:function(e){chrome.contextMenus.update("ThunderContextMenu",{enabled:e})},updataToolbarBadgeText:function(e,t){var i={text:e,tabId:t};chrome.browserAction.setBadgeText(i)},updataToolbarTips:function(e,t){var i={title:e,tabId:t};chrome.browserAction.setTitle(i)},updateBrowserActionIcon:function(e,t){var i={path:e,tabId:t};chrome.browserAction.setIcon(i)},setToolbarEnableStatus:function(e){this.updateBrowserActionIcon("images/icon19_normal.png",e);this.updataToolbarTips("迅雷Chrome支持",e);this.updataToolbarBadgeText("",e)},setToolbarDisableStatus:function(e){this.updateBrowserActionIcon("images/icon19_disabled.png",e);this.updataToolbarTips("迅雷Chrome支持已被禁用",e);this.updataToolbarBadgeText("",e)},setToolbarExceptionStatus:function(){this.updateBrowserActionIcon("images/icon19_normal.png");this.updataToolbarTips("迅雷Chrome支持出现异常");this.updataToolbarBadgeText("!")},setToolbarPageDisableStatus:function(e){this.updateBrowserActionIcon("images/icon19_pageDisable.png",e);this.updataToolbarTips("当前页面已禁用迅雷Chrome支持",e);this.updataToolbarBadgeText("",e)},invokeThunder:function(e){var t="#@$@#";var i=e.headers["referer"]||"";i=i.concat(t);i=i.concat(1,t);i=i.concat(e.url,t);i=i.concat(e.fileName,t);i=i.concat("",t);i=i.concat(e.headers["cookie"],t);i=i.concat("",t);i=i.concat("",t);XLNativeMessage.connect();stat(1022,918);XLNativeMessage.postMessage("DownLoadByThunder",[i]);XLNativeMessage.sendQuit()},downloadByThunder:function(t,i){if(i.headers["referer"]&&0!==i.headers["referer"].length){this.invokeThunder(i)}else if(t===undefined||t<0){this.invokeThunder(i)}else{var a=this;chrome.tabs.executeScript(t,{code:"document.referrer;"},function(e){if(!e){e=""}if(Array.isArray(e)&&e.length>0){e=e[0]}i.headers["referer"]=e;if(0===i.headers["referer"].length){chrome.tabs.executeScript(t,{code:"document.location.href;"},function(e){if(!e){e=""}if(Array.isArray(e)&&e.length>0){e=e[0]}i.headers["referer"]=e;a.invokeThunder(i)})}else{a.invokeThunder(i)}})}},enumTabSetEnabled:function(r){var o=this;chrome.tabs.query({active:true},function e(t){if(t){for(var i=0;i<t.length;i++){var a=t[i];var s=!o.checkIsWebsiteInUserBlackList(a.url);var n=!o.checkIsPageInUserBlackList(a.url);o.setToolbarStatus(o.exception,r,s,n,a.id)}}})},setPluginEnabled:function(t){XLNativeMessage.connect();chrome.tabs.getSelected(null,function(e){chrome.tabs.sendMessage(e.id,{name:"UpdatePluginEnabled",enable:t})});this.pluginEnabled=t;this.enumTabSetEnabled(t);this.updateContextMenu(t);XLNativeMessage.postMessage("SetPluginEnabled",[t]);XLNativeMessage.sendQuit()},setMoniterDynamicLinks:function(t){XLNativeMessage.connect();chrome.tabs.getSelected(null,function(e){chrome.tabs.sendMessage(e.id,{name:"UpdateMoniterDynamicLinks",enable:t})});this.moniterDynamicLinks=t;XLNativeMessage.postMessage("SetMoniterDynamicLinks",[t]);XLNativeMessage.sendQuit()},onAddBlackListPage:function(e,t,i){if(e&&t[0].retVal){chrome.tabs.getSelected(null,function(e){chrome.tabs.sendMessage(e.id,{name:"UpdatePageEnabled",enable:false})});this.blackListPageArray[this.blackListPageArray.length]=i[0]}XLNativeMessage.sendQuit()},addBlackListPage:function(e,t){XLNativeMessage.connect();for(var i in this.blackListPageArray){if(this.blackListPageArray[i]===e){return}}XLNativeMessage.postMessage("AddBlackListPage",[e],this,this.onAddBlackListPage);this.setToolbarStatus(this.exception,this.pluginEnabled,true,false,t)},onRemoveBlackListPage:function(e,t,i){if(e&&t[0].retVal){chrome.tabs.getSelected(null,function(e){chrome.tabs.sendMessage(e.id,{name:"UpdatePageEnabled",enable:true})});for(var a in this.blackListPageArray){if(this.blackListPageArray[a]===i[0]){delete this.blackListPageArray[a]}}}XLNativeMessage.sendQuit()},removeBlackListPage:function(e,t){XLNativeMessage.connect();for(var i in this.blackListPageArray){if(this.blackListPageArray[i]===e){XLNativeMessage.postMessage("RemoveBlackListPage",[e],this,this.onRemoveBlackListPage);this.setToolbarStatus(this.exception,this.pluginEnabled,true,true,t);break}}},onAddBlackListWebsite:function(e,t,i){if(e&&t[0].retVal){chrome.tabs.getSelected(null,function(e){chrome.tabs.sendMessage(e.id,{name:"UpdateWebsiteEnabled",enable:false})});this.blackListWebsiteArray[this.blackListWebsiteArray.length]=i[0]}XLNativeMessage.sendQuit()},addBlackListWebsite:function(e,t){XLNativeMessage.connect();for(var i in this.blackListWebsiteArray){if(this.blackListWebsiteArray[i]===e){return}}XLNativeMessage.postMessage("AddBlackListWebsite",[e],this,this.onAddBlackListWebsite);this.setToolbarStatus(this.exception,this.pluginEnabled,false,true,t)},onRemoveBlackListWebsite:function(e,t,i){if(e&&t[0].retVal){chrome.tabs.getSelected(null,function(e){chrome.tabs.sendMessage(e.id,{name:"UpdateWebsiteEnabled",enable:true})});for(var a in this.blackListWebsiteArray){if(this.blackListWebsiteArray[a]===i[0]){delete this.blackListWebsiteArray[a]}}}XLNativeMessage.sendQuit()},removeBlackListWebsite:function(e,t,i,a){XLNativeMessage.connect();for(var s in this.blackListWebsiteArray){if(this.blackListWebsiteArray[s]===e){XLNativeMessage.postMessage("RemoveBlackListWebsite",[e],this,this.onRemoveBlackListWebsite);if(a===undefined){a=!this.checkIsPageInUserBlackList(t)}this.setToolbarStatus(this.exception,this.pluginEnabled,true,a,i);break}}},checkIsWebsiteInUserBlackList:function(e){var t=false;do{for(var i in this.blackListWebsiteArray){if(e.indexOf(this.blackListWebsiteArray[i])===0){t=true;break}}}while(0);return t},checkIsPageInUserBlackList:function(e){var t=false;do{for(var i in this.blackListPageArray){if(e===this.blackListPageArray[i]){t=true;break}}}while(0);return t},canDownload:function(e){var t=e.tabId;var i=e.url;var a=e.ext;if(!this.pluginEnabled){return false}if(!this.enabledCapture){return false}var s="";if(this.tabUrls[t]&&this.tabUrls[t]!==""){s=this.tabUrls[t]}else{s=e.headers["referer"]||""}if(this.checkIsWebsiteInUserBlackList(s)){return false}if(this.checkIsPageInUserBlackList(s)){return false}if(!this.isMoniterUrl(t,i,s)){return false}return true},isValidUrlAndMonitorProtocol:function(e){var t="HTTP://HTTPS://FTP://THUNDER://MMS://MMST://RTSP://RTSPU://XLAPP://";var i="ED2K://";var a="MAGNET:?";if(e.length===0){return false}var s=e;var n=s.indexOf(":");if(n===-1){return false}var r=s.substr(0,n+1);var o=r.toUpperCase();if(o===""){return false}var l=true;if(i.indexOf(o)!==-1){if(this.monitorEmule===false){l=false}}else if(a.indexOf(o)!==-1){if(this.monitorMagnet===false){l=false}}else if(t.indexOf(o)!==-1){if(this.monitorTradition===false){l=false}}else{l=false}return l},isMonitorDomain:function(e){if(e.length===0){return true}var t=new Array;var i=this.monitorDemains.split("||");for(var a in i){var s=i[a].slice(2);var n=s.trimRight("|");t.push(n)}var r=true;var o=e;for(var l in t){if(t[l].length>0&&o.indexOf(t[l])!==-1){r=false;break}}return r},isFilterDomain:function(e){if(e.length===0){return false}if(this.filterDemains.length===0){return false}var t=new Array;var i=this.filterDemains.split("||");for(var a in i){var s=i[a].slice(2).toLowerCase();var n=s.trimRight("|");t.push(n)}var r=false;var o=e.toLowerCase();for(var l in t){if(t[l]>0&&o.indexOf(t[l])!==-1){r=true;break}}return r},getExtensionFileName:function(e){var t=/(\\+)/g;var i=e.replace(t,"#");var a=i.split("#");var s=a[a.length-1];var n=s.split(".");return n[n.length-1]},isMonitorFileExt:function(e){var t=false;do{if(e.length===0){return false}e=e.toLowerCase();e+=";";if(this.monitorFileExts.indexOf(e)!==-1){t=true}}while(false);return t},isMoniterUrl:function(e,t,i){if(t.length===0){return false}if(this.monitorIE===false){return false}if(this.isValidUrlAndMonitorProtocol(t)===false){return false}if(i.length===0){i=t}if(this.isMonitorDomain(i)===false){return false}if(this.isFilterDomain(i)){return false}return true},onIsDownloadURL:function(e,t,i){if(e){if(t[0].retVal){var a=new RequestItem;a.url=i[0];a.headers["cookie"]=i[1];a.headers["referer"]=i[2];this.invokeThunder(a)}else{window.open(i[0])}XLNativeMessage.sendQuit()}},onBeforeSendHeaders:function(e){do{if(this.moniterDynamicLinks){break}if(!this.isSupportRequestType(e.type)){break}var t=this.requestItems[e.requestId];if(!t){t=new RequestItem;this.requestItems[e.requestId]=t}t.tabId=e.tabId;var i=e.url;if(!t.url||t.url.length===0){t.url=i}for(var a=0;a<e.requestHeaders.length;++a){var s=e.requestHeaders[a].name.toLowerCase();var n=e.requestHeaders[a].value;switch(s){case"user-agent":t.headers["user-agent"]=n;break;case"referer":t.headers["referer"]=n;break;case"cookie":t.headers["cookie"]=n;break;case"content-type":t.headers["content-type"]=n;default:;}}}while(false);return{}},onHeadersReceived:function(e){do{if(this.moniterDynamicLinks){break}var t=e.statusCode;if(t>=300&&t<400&&t!==304){break}var i=e.statusLine;if(i.indexOf("HTTP/1.1 204 Intercepted by the Xunlei Advanced Integration")===0){break}var a=e.type;if(!this.isSupportRequestType(a)){break}var s=e.url;var n=this.requestItems[e.requestId];if(!n){n=new RequestItem;n.tabId=e.tabId}else{delete this.requestItems[e.requestId]}for(var r=0;r<e.responseHeaders.length;++r){var o=e.responseHeaders[r].name.toLowerCase();var l=e.responseHeaders[r].value;switch(o){case"referer":n.headers["referer"]=l;break;case"set-cookie":if(0===n.headers["cookie"].length){n.headers["cookie"]=l}else{n.headers["cookie"]=n.headers["cookie"]+"; "+l}break;case"access-control-allow-origin":originHender="Origin: "+l;break;case"host":n.headers["host"]=l;break;case"content-disposition":n.headers["content-disposition"]=l;break;case"content-length":n.headers["content-length"]=l;break;case"content-type":n.headers["content-type"]=l;default:;}}if(0===s.length){s=host}if(0===n.url.length){n.url=s}if(!this.isFrameRequestType(a)){if(0===n.fileName.length){n.fileName=this.getUrlFileName(n.url)}var c=this.getFileNameExt(n.fileName);if(0===c.length){var u=this.getUrlFileName(n.url);c=this.getFileNameExt(u)}var d=n.headers["content-type"];if(0===d.length){if(!this.isSupportMediaExt(c)){break}}if(parseInt(n.headers["content-length"])<2*(1024^2)||"swf"===c){break}if(this.isSupportContentType(d)){break}break}if(!this.isValidDownload(n)){break}if(2!==Math.round(e.statusCode/100)&&"other"===a){break}this.blockDownload=true;this.downloadByThunder(e.tabId,n)}while(false);return{}},onTabCreated:function(e){this.tabUrls[e.id]=e.url},onTabActivated:function(e){chrome.tabs.sendMessage(e.tabId,{name:"OnActivated",tabId:e.tabId});this.currentTabId=e.tabId},onTabRemoved:function(e,t){if(e in this.requestItems){delete this.requestItems[e]}if(e in this.tabUrls){delete this.tabUrls[e]}},onTabUpdated:function(e,t,i){if(t.url){this.tabUrls[e]=t.url}},onQueryAllTabs:function(e){if(e&&e.length>0){for(var t=0;t<e.length;++t){this.tabUrls[e[t].id]=e[t].url}}},cancelChromeDownload:function(e){chrome.downloads.cancel(e.id);chrome.downloads.erase({id:e.id},function(e){});if(e.url!==e.referrer){if(e.url==="about:blank"){chrome.tabs.getSelected(null,function(e){if(e&&e.url===""){chrome.tabs.remove(e.id)}})}else if(e.referrer!==""){chrome.tabs.query({url:e.url},function e(t){if(t&&t[0]){chrome.tabs.remove(t[0].id)}})}}},tryDownload:function(e){do{var t=e.url;if(e.finalUrl){t=e.finalUrl}var i=new RequestItem;i.url=t;i.headers["referer"]=e.referrer;if(!this.canDownload(i)){break}this.cancelChromeDownload(e);if(e.referrer===""){this.invokeThunder(i);break}var a=this;chrome.tabs.query({url:e.referrer},function e(t){if(t&&t[0]){chrome.tabs.sendMessage(t[0].id,{name:"GetCookie"},function(e){var t="";if(e&&e.cookie){t=e.cookie}i.headers["cookie"]=t;a.invokeThunder(i)})}else{a.invokeThunder(i)}})}while(0)},onDownloadCreated:function(t){do{if(t.state==="complete"||t.state==="interrupted"){break}if(this.blockDownload){this.blockDownload=false;this.cancelChromeDownload(t)}else if(this.moniterDynamicLinks){if(t.referrer===""){var i=this;chrome.tabs.getSelected(null,function(e){t.referrer=e.url;i.tryDownload(t)})}else{this.tryDownload(t)}}}while(0)},registerEventListener:function(){var o=this;chrome.extension.onRequest.addListener(function(e,t,i){if(e.name==="xl_download"){var a=new RequestItem;a.url=e.link;a.headers["cookie"]=e.cookie;a.headers["referer"]=e.referurl;o.invokeThunder(a)}else if(e.name==="EnabledCapture"){this.enabledCapture=e.capture}else if(e.name==="CheckActivated"){chrome.tabs.query({url:e.url},function e(t){if(t){for(var i=0;i<t.length;i++){var a=t[i];if(a.active){chrome.tabs.sendMessage(a.id,{name:"OnActivated",tabId:a.id})}}}})}else if(e.name==="CheckEnabled"){var s=o.pluginEnabled;var n=!o.checkIsWebsiteInUserBlackList(e.url);var r=!o.checkIsPageInUserBlackList(e.url);i({bPlugin:s,bWebsite:n,bPage:r});o.setToolbarStatus(o.exception,o.pluginEnabled,n,r,e.tabId)}else if(e.name==="CheckbMoniterDynamicLinks"){i({bMoniterDynamicLinks:o.moniterDynamicLinks})}else if(e.name==="xl_check_url"){XLNativeMessage.postMessage("IsDownloadURL",[e.link,e.cookie,e.referurl],o,o.onIsDownloadURL)}else if(e.name==="GetConfig"){i({bMonitorEmule:o.monitorEmule,bMonitorMagnet:o.monitorMagnet,bMonitorTradition:o.monitorTradition,bMonitorIE:o.monitorIE,monitorDemains:o.monitorDemains,filterDemains:o.filterDemains,monitorFileExts:o.monitorFileExts})}});if(this.bUseChromeDownloadAPI){chrome.downloads.onCreated.addListener(function(e){return o.onDownloadCreated(e)})}if(chrome.webRequest){chrome.webRequest.onHeadersReceived.addListener(function(e){return o.onHeadersReceived(e)},{urls:["<all_urls>"]},["blocking","responseHeaders"]);chrome.webRequest.onBeforeSendHeaders.addListener(function(e){return o.onBeforeSendHeaders(e)},{urls:["<all_urls>"]},["blocking","requestHeaders"])}if(chrome.tabs){chrome.tabs.onCreated.addListener(function(e){return o.onTabCreated(e)});chrome.tabs.onActivated.addListener(function(e){o.onTabActivated(e)});chrome.tabs.onRemoved.addListener(function(e,t){o.onTabRemoved(e,t)});chrome.tabs.onUpdated.addListener(function(e,t,i){o.onTabUpdated(e,t,i)});chrome.tabs.query({},function(e){o.onQueryAllTabs(e)})}},setToolbarStatus:function(e,t,i,a,s){do{if(e){this.setToolbarExceptionStatus();break}if(!t){this.setToolbarDisableStatus(s);break}if(i&&a){this.setToolbarEnableStatus(s);break}else{this.setToolbarPageDisableStatus(s);break}}while(false)},onStartupThunder:function(s,e){var n=this;chrome.cookies.getAll({url:s.linkUrl},function(e){var t="";for(i in e){t=t.concat(e[i].name,"=",e[i].value,"; ")}var a=new RequestItem;a.url=s.linkUrl;a.headers["cookie"]=t;a.headers["referer"]=s.pageUrl;n.invokeThunder(a)})},createContextMenu:function(e){var i=this;var t={id:"ThunderContextMenu",type:"normal",title:chrome.i18n.getMessage("context_title"),contexts:["link"],onclick:function(e,t){i.onStartupThunder(e,t)},enabled:e};chrome.contextMenus.create(t,function(){})},onGetMoniterDynamicLinks:function(e,t,i){if(e){this.moniterDynamicLinks=t[0].retVal;stat(1022,917,"value1="+(this.moniterDynamicLinks?"1":"0"))}},onGetBlackListWebsites:function(e,t,i){if(e){if(t[0].retVal){this.blackListWebsiteArray=t[1].blackList}else{this.blackListWebsiteArray=[]}}},onGetBlackListPages:function(e,t,i){if(e){if(t[0].retVal){this.blackListPageArray=t[1].blackList}else{this.blackListPageArray=[]}}},onGetIsMonitorProtocol:function(e,t,i){if(e&&t[0].retVal){if(i[0]==="MonitorEmule"){this.monitorEmule=t[1].value}else if(i[0]==="MonitorMagnet"){this.monitorMagnet=t[1].value}else if(i[0]==="MonitorTradition"){this.monitorTradition=t[1].value}else if(i[0]==="MonitorIE"){this.monitorIE=t[1].value}}},onGetFiters:function(e,t,i){if(e){if(t[0].retVal){if(i[0]==="MonitorDemain"){this.monitorDemains=t[1].value}else if(i[0]==="FilterDemain"){this.filterDemains=t[1].value}else if(i[0]==="MonitorFileExt"){this.monitorFileExts=t[1].value}}XLNativeMessage.sendQuit()}},onGetPluginEnabled:function(e,t,i){do{if(!e){break}this.pluginEnabled=t[0].retVal;this.updateContextMenu(this.pluginEnabled);this.pluginEnabled?this.setToolbarEnableStatus():this.setToolbarDisableStatus();XLNativeMessage.postMessage("GetMoniterDynamicLinks",[],this,this.onGetMoniterDynamicLinks);XLNativeMessage.postMessage("GetBlackListWebsites",[],this,this.onGetBlackListWebsites);XLNativeMessage.postMessage("GetBlackListPages",[],this,this.onGetBlackListPages);XLNativeMessage.postMessage("GetIsMonitorProtocol",["MonitorEmule"],this,this.onGetIsMonitorProtocol);XLNativeMessage.postMessage("GetIsMonitorProtocol",["MonitorMagnet"],this,this.onGetIsMonitorProtocol);XLNativeMessage.postMessage("GetIsMonitorProtocol",["MonitorTradition"],this,this.onGetIsMonitorProtocol);XLNativeMessage.postMessage("GetIsMonitorProtocol",["MonitorIE"],this,this.onGetIsMonitorProtocol);XLNativeMessage.postMessage("GetFiters",["MonitorDemain"],this,this.onGetFiters);XLNativeMessage.postMessage("GetFiters",["FilterDemain"],this,this.onGetFiters);XLNativeMessage.postMessage("GetFiters",["MonitorFileExt"],this,this.onGetFiters);stat(1022,916,"value1="+(this.pluginEnabled?"1":"0"))}while(false)},feedback:function(){XLNativeMessage.connect();XLNativeMessage.postMessage("GetThunderInfo",[],undefined,function(e,t,i){var a="";var s="";if(e){a=t[0].peerId;s=t[0].thunderVersion}var n="http://misc-xl9-ssl.xunlei.com/client/view/dist/1.0/feedback.html?version="+s+"&pid="+a;chrome.tabs.create({url:n},function(){})});XLNativeMessage.sendQuit()},onDisconnect:function(e){if(!e){this.pluginEnabled=false;this.exception=true;this.setToolbarExceptionStatus();chrome.tabs.getAllInWindow(null,function(e){for(var t in e){chrome.tabs.sendMessage(e[t].id,{name:"UpdatePluginEnabled",enable:this.pluginEnabled})}})}},init:function(){XLNativeMessage.attachDisconnectEvent(this,this.onDisconnect);var e=XLNativeMessage.connect();if(e){XLNativeMessage.postMessage("GetPluginEnabled",[],this,this.onGetPluginEnabled)}else{this.pluginEnabled=false;this.exception=true;this.setToolbarExceptionStatus();stat(1022,919)}this.createContextMenu(false);this.registerEventListener();stat(1022,920)}};function Backgroud(){this.pluginEnabled=true;this.exception=false;this.moniterDynamicLinks=false;this.blackListWebsiteArray;this.blackListPageArray;this.monitorEmule=false;this.monitorMagnet=false;this.monitorTradition=false;this.monitorIE=false;this.enabledCapture=true;this.monitorDemains;this.filterDemains;this.monitorFileExts;this.bUseChromeDownloadAPI=chrome.downloads?true:false}var XLBackgroud=new Backgroud;XLBackgroud.init();function onFeedback(){XLBackgroud.feedback()}function setPluginEnabled(e){XLBackgroud.setPluginEnabled(e)}function setMoniterDynamicLinks(e){XLBackgroud.setMoniterDynamicLinks(e)}function removeBlackListPage(e,t){XLBackgroud.removeBlackListPage(e,t)}function removeBlackListWebsite(e,t,i,a){XLBackgroud.removeBlackListWebsite(e,t,i,a)}function addBlackListPage(e,t){XLBackgroud.addBlackListPage(e,t)}function addBlackListWebsite(e,t){XLBackgroud.addBlackListWebsite(e,t)}function isException(){return XLBackgroud.exception}function isPluginEnabled(){return XLBackgroud.pluginEnabled}function isUseChromeDownloadAPI(){return XLBackgroud.bUseChromeDownloadAPI}function isMoniterDynamicLinks(){return XLBackgroud.moniterDynamicLinks}function checkIsWebsiteInUserBlackList(e){return XLBackgroud.checkIsWebsiteInUserBlackList(e)}function checkIsPageInUserBlackList(e){return XLBackgroud.checkIsPageInUserBlackList(e)}