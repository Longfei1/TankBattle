var extension;var bPluginEnabled;var bMoniterDynamicLinks;var bIsInWebsiteBlackList;var bIsInPageBlackList;function OnClickThunderChromeSupport(e){extension.setPluginEnabled(!bPluginEnabled);window.close()}function OnClickMoniterDynamicLinks(e){if(bPluginEnabled){extension.setMoniterDynamicLinks(!bMoniterDynamicLinks);window.close()}}function OnClickThisPageDisableThunder(e){if(bPluginEnabled){chrome.tabs.getSelected(null,function(e){if(bIsInPageBlackList){extension.removeBlackListPage(e.url,e.id)}if(bIsInWebsiteBlackList){var n=e.url;var i=n.indexOf("://");if(i>=0){var t;var s=n.indexOf("/",i+3);if(s>=0){t=n.substring(0,s)}else{t=n}extension.removeBlackListWebsite(t,e.url,e.id,true)}}else{if(!bIsInPageBlackList){extension.addBlackListPage(e.url,e.id)}}});window.close()}}function OnClickThisWebsiteDisableThunder(e){if(bPluginEnabled){chrome.tabs.getSelected(null,function(e){var n=e.url;var i=n.indexOf("://");if(i>=0){var t;var s=n.indexOf("/",i+3);if(s>=0){t=n.substring(0,s)}else{t=n}if(bIsInWebsiteBlackList){extension.removeBlackListWebsite(t,e.url,e.id)}else{extension.addBlackListWebsite(t,e.id)}}});window.close()}}function OnClickFeedback(e){extension.onFeedback()}function OnClickDownloadNewClientInstallExe(e){var n="http://x.xunlei.com/";chrome.tabs.create({url:n},function(){})}function ShowGuidePage(){var e=document.getElementById("ThunderChromeSupport");document.body.removeChild(e.parentNode);var n=document.getElementById("MoniterDynamicLinks");document.body.removeChild(n.parentNode);var i=document.getElementById("ThisPageDisableThunder");document.body.removeChild(i.parentNode);var t=document.getElementById("Feedback");document.body.removeChild(t.parentNode);var s=document.createElement("p");s.innerHTML="<div class=\"guide\"><b><h3><font color='red'>迅雷下载支持异常</font></h3></b></div>";document.body.appendChild(s);var a=document.createElement("p");a.innerHTML='<div class="guide">您可能没有安装迅雷，或已安装的迅雷不完整，请您下载安装最新版本的迅雷！<br>（安装完成后，请重启Chrome浏览器）</div>';document.body.appendChild(a);var l=document.createElement("p");l.setAttribute("align","center");align=l.attributes.getNamedItem("align").value="center";l.innerHTML='<div class="downloadBtn">立即下载</div>';document.body.appendChild(l);l.addEventListener("click",OnClickDownloadNewClientInstallExe)}function Init(){extension=chrome.extension.getBackgroundPage();if(extension.isException()){ShowGuidePage();return}bPluginEnabled=extension.isPluginEnabled();if(bPluginEnabled){document.getElementById("ThunderChromeSupport").className="item item-select";var e=extension.isUseChromeDownloadAPI();if(e){bMoniterDynamicLinks=extension.isMoniterDynamicLinks();if(bMoniterDynamicLinks){document.getElementById("MoniterDynamicLinks").className="item item-select"}}else{document.getElementById("MoniterDynamicLinks").className="item-disable"}chrome.tabs.getSelected(null,function(e){bIsInWebsiteBlackList=extension.checkIsWebsiteInUserBlackList(e.url);bIsInPageBlackList=extension.checkIsPageInUserBlackList(e.url);if(bIsInWebsiteBlackList){document.getElementById("ThisPageDisableThunder").className="item item-select";document.getElementById("ThisWebsiteDisableThunder").className="item item-select"}else{if(bIsInPageBlackList){document.getElementById("ThisPageDisableThunder").className="item item-select"}}})}else{document.getElementById("ThunderChromeSupport").className="item";document.getElementById("MoniterDynamicLinks").className="item-disable";document.getElementById("ThisPageDisableThunder").className="item-disable";document.getElementById("ThisWebsiteDisableThunder").className="item-disable"}}document.addEventListener("DOMContentLoaded",function(){document.getElementById("ThunderChromeSupport").addEventListener("click",OnClickThunderChromeSupport);document.getElementById("MoniterDynamicLinks").addEventListener("click",OnClickMoniterDynamicLinks);document.getElementById("ThisPageDisableThunder").addEventListener("click",OnClickThisPageDisableThunder);document.getElementById("ThisWebsiteDisableThunder").addEventListener("click",OnClickThisWebsiteDisableThunder);document.getElementById("Feedback").addEventListener("click",OnClickFeedback);Init()});